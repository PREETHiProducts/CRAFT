<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PRiTHI PRODUCTS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">

<style>
    /* ORIGINAL STYLES PRESERVED */
    *{ margin:0; padding:0; box-sizing:border-box; }
    html,body{ width:100%; height:100%; scroll-behavior: smooth; }
    body{ font-family:'Poppins',sans-serif; background:linear-gradient(135deg,#fff5f8 0%,#ffd6eb 50%,#e0c3fc 100%); overflow-x:hidden; }
    #bgCanvas{ position:fixed; inset:0; width:100%; height:100%; z-index:0; pointer-events:none; }

    /* FIXED SIGN IN BUTTON */
    .auth-btn-container {
        position: fixed;
        top: 25px;
        right: 30px;
        z-index: 100;
    }
    #signInBtn {
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(10px);
        border: 1px solid #8e44ad;
        padding: 10px 24px;
        border-radius: 30px;
        color: #8e44ad;
        font-weight: bold;
        cursor: pointer;
        transition: 0.3s;
    }
    #signInBtn:hover { background: #8e44ad; color: white; }

    /* NAV */
    nav{ position:relative; z-index:10; margin:18px auto; width:min(96%,1300px); padding:14px 28px; background:rgba(255,255,255,.45); backdrop-filter:blur(12px); border-radius:60px; display:flex; justify-content:center; align-items:center; border:1px solid rgba(255,255,255,.55); }
    nav ul{ display:flex; gap:26px; list-style:none; }
    nav li{ font-size:14px; color:#8e44ad; font-weight:500; cursor: pointer; }

    /* HERO */
    .hero{ position:relative; z-index:5; min-height:calc(100vh - 120px); display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center; padding-inline:16px; }
    svg{ width:100%; max-width:1000px; height:auto; }
    text{ font-family:'Playfair Display',serif; font-size:clamp(46px,9vw,92px); letter-spacing:6px; fill:#6a004b; filter:drop-shadow(0 6px 14px rgba(106,0,75,.25)); }
    .bouquet{ width:clamp(260px,70vw,420px); max-width:92%; margin-top:-6vh; filter:drop-shadow(0 22px 32px rgba(0,0,0,.18)); animation:float 6s ease-in-out infinite; }
    @keyframes float{ 0%,100%{transform:translateY(0)} 50%{transform:translateY(-24px)} }
    .tagline{ margin-top:14px; font-size:clamp(11px,2.4vw,14px); letter-spacing:2.5px; text-transform:uppercase; color:#8e44ad; }

    /* COLLECTION SECTION */
    #collection { position: relative; z-index: 10; padding: 100px 5%; display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 30px; max-width: 1300px; margin: 0 auto; }
    .product-card {
        background: rgba(255, 255, 255, 0.7);
        backdrop-filter: blur(15px);
        border-radius: 24px;
        padding: 20px;
        text-align: center;
        border: 1px solid rgba(255,255,255,0.4);
        box-shadow: 0 15px 35px rgba(0,0,0,0.05);
        transition: transform 0.3s;
    }
    .product-card:hover { transform: translateY(-10px); }
    .product-img { width: 100%; height: 250px; object-fit: cover; border-radius: 18px; margin-bottom: 15px; }
    .product-name { font-size: 1.4rem; color: #6a004b; margin-bottom: 10px; font-family: 'Playfair Display', serif; }
    .price-tag { font-size: 1.2rem; color: #8e44ad; font-weight: 600; }
    .discount { color: #e74c3c; font-size: 0.9rem; text-decoration: line-through; margin-left: 10px; }
    .card-btns { display: flex; gap: 10px; margin-top: 20px; justify-content: center; }
    .btn { padding: 10px 18px; border-radius: 12px; border: none; cursor: pointer; font-weight: 600; transition: 0.2s; }
    .btn-buy { background: #6a004b; color: white; }
    .btn-cart { background: transparent; border: 1.5px solid #6a004b; color: #6a004b; }
    .btn:hover { opacity: 0.8; }

    /* CART SIDEBAR */
    #cartSidebar {
        position: fixed; right: -400px; top: 0; width: 350px; height: 100%;
        background: white; z-index: 1000; transition: 0.4s; padding: 30px;
        box-shadow: -10px 0 30px rgba(0,0,0,0.1);
    }
    #cartSidebar.active { right: 0; }
    .cart-item { display: flex; justify-content: space-between; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee; }
    .checkout-btn { width: 100%; padding: 15px; background: #8e44ad; color: white; border: none; border-radius: 12px; margin-top: 20px; cursor: pointer; }

    /* Responsive adjustments */
    @media (max-width:768px){ 
        .auth-btn-container { top: 10px; right: 10px; }
        #cartSidebar { width: 100%; right: -100%; }
    }
    @media (min-width:768px){
    text{
        font-size:clamp(58px,7vw,96px);
    }
    .bouquet{
        width:clamp(320px,45vw,520px);
        margin-top:-9vh;
    }
}

    @media (max-width:768px){
        text{
            font-size:clamp(80px,9vw,100px);
        }
        .bouquet{
            width:clamp(320px,45vw,520px);
            margin-top:-9vh;
        }
    }
    /* ===== LAPTOPS ===== */
    @media (min-width:1024px){
        text{
            font-size:clamp(55px,4vw,104px);
        }
        .bouquet{
            width:clamp(450px,32vw,620px);
            margin-top:-20vh;
        }
    }

    /* ===== LARGE SCREENS / TV ===== */
    @media (min-width:1600px){
        section{
            min-height:92vh;
        }
        text{
            font-size:110px;
        }
        .bouquet{
            width:720px;
            margin-top:-14vh;
        }
    }
</style>
</head>

<body>

<canvas id="bgCanvas"></canvas>

<div class="auth-btn-container">
    <button id="signInBtn">Sign In</button>
</div>

<nav>
    <ul>
        <li onclick="document.getElementById('collection').scrollIntoView()">Collection</li>
        <li onclick="toggleCart()">Cart (<span id="cartCount">0</span>)</li>
        <li>Contact</li>
    </ul>
</nav>

<section class="hero">
    <svg viewBox="0 0 1000 220" preserveAspectRatio="xMidYMid meet">
        <defs><path id="curve" d="M80,160 Q500,10 920,160"/></defs>
        <text><textPath href="#curve" startOffset="50%" text-anchor="middle">PREETHi PRODUCTS</textPath></text>
    </svg>
    <img src="bouquet.png" class="bouquet" alt="Flower Bouquet">
    <div class="tagline">Crafted with Care â€¢ Delivered with Joy</div>
</section>

<div id="collection">
    <div class="product-card">
        <img src="https://images.unsplash.com/photo-1526047932273-341f2a7631f9?auto=format&fit=crop&w=500" class="product-img">
        <h3 class="product-name">Royal Rose Bloom</h3>
        <p class="price-tag">Rs.500.00 <span class="discount">Rs.850.00</span></p>
        <div class="card-btns">
            <button class="btn btn-cart" onclick="addToCart('Royal Rose Bloom', 45)">Add to Cart</button>
            <button class="btn btn-buy">Buy Now</button>
        </div>
    </div>
    <div class="product-card">
        <img src="https://images.unsplash.com/photo-1582794543139-8ac9cb0f7b11?auto=format&fit=crop&w=500" class="product-img">
        <h3 class="product-name">Lavender Mist</h3>
        <p class="price-tag">Rs.600.00</p> <div class="card-btns">
            <button class="btn btn-cart" onclick="addToCart('Lavender Mist', 32)">Add to Cart</button>
            <button class="btn btn-buy">Buy Now</button>
        </div>
    </div>
    <div class="product-card">
        <img src="https://images.unsplash.com/photo-1490750967868-88aa4486c946?auto=format&fit=crop&w=500" class="product-img">
        <h3 class="product-name">Spring Daisy</h3>
        <p class="price-tag">Rs.1000.00 <span class="discount">Rs.1350.00</span></p>
        <div class="card-btns">
            <button class="btn btn-cart" onclick="addToCart('Spring Daisy', 28)">Add to Cart</button>
            <button class="btn btn-buy">Buy Now</button>
        </div>
    </div>
    <div class="product-card">
        <img src="https://images.unsplash.com/photo-1561181286-d3fee7d55364?auto=format&fit=crop&w=500" class="product-img">
        <h3 class="product-name">White Lily Vase</h3>
        <p class="price-tag">Rs.550.00</p>
        <div class="card-btns">
            <button class="btn btn-cart" onclick="addToCart('White Lily Vase', 55)">Add to Cart</button>
            <button class="btn btn-buy">Buy Now</button>
        </div>
    </div>
</div>

<div id="cartSidebar">
    <h2 style="color:#6a004b">Your Cart</h2>
    <hr style="margin:20px 0">
    <div id="cartItems"></div>
    <div style="margin-top:20px">
        <strong>Total: $<span id="cartTotal">0</span></strong>
    </div>
    <button class="checkout-btn" onclick="checkout()">Buy All Items (One Click)</button>
    <button onclick="toggleCart()" style="background:none; border:none; margin-top:15px; cursor:pointer; color:#8e44ad;">Close</button>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
    import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
    import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyD8nbG5Pfjo1cAGf5dG6vgTsyDl5MAFpv0",
        authDomain: "craft-72780.firebaseapp.com",
        projectId: "craft-72780",
        storageBucket: "craft-72780.firebasestorage.app",
        messagingSenderId: "911657969290",
        appId: "1:911657969290:web:0890417efcc2eeaa34ef73",
        measurementId: "G-B5WRW9556N"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const provider = new GoogleAuthProvider();
    
    // Force Google to show the account selector every time
    provider.setCustomParameters({ prompt: 'select_account' });

    let currentUser = null;
    let cart = [];

    // --- FIX: SIGN IN LOGIC ---
    const authBtn = document.getElementById('signInBtn');
    
    authBtn.addEventListener('click', async () => {
        if (!currentUser) {
            try {
                const result = await signInWithPopup(auth, provider);
                console.log("User signed in:", result.user.email);
            } catch (error) {
                console.error("Auth Error:", error.code, error.message);
                alert("Login failed: " + error.message);
            }
        } else {
            signOut(auth).then(() => {
                alert("Signed out successfully");
            });
        }
    });

    onAuthStateChanged(auth, async (user) => {
        if (user) {
            currentUser = user;
            authBtn.innerText = `Sign Out (${user.displayName.split(' ')[0]})`;
            // Load cart from Firebase
            const docRef = doc(db, "carts", user.email);
            const docSnap = await getDoc(docRef);
            if (docSnap.exists()) {
                cart = docSnap.data().items || [];
                updateCartUI();
            }
        } else {
            currentUser = null;
            authBtn.innerText = "Sign In";
            cart = [];
            updateCartUI();
        }
    });

    // --- CART LOGIC ---
    window.addToCart = async (name, price) => {
        cart.push({ name, price });
        updateCartUI();
        
        if (currentUser) {
            try {
                await setDoc(doc(db, "carts", currentUser.email), { items: cart });
            } catch (e) {
                console.error("Error saving cart: ", e);
            }
        } else {
            alert("Please sign in to save your cart to your account!");
        }
    };

    window.updateCartUI = () => {
        const container = document.getElementById('cartItems');
        const countSpan = document.getElementById('cartCount');
        const totalSpan = document.getElementById('cartTotal');
        
        container.innerHTML = '';
        let total = 0;
        
        cart.forEach((item) => {
            total += item.price;
            container.innerHTML += `
                <div class="cart-item">
                    <span>${item.name}</span>
                    <span>Rs.${item.price}.00</span>
                </div>
            `;
        });
        
        countSpan.innerText = cart.length;
        totalSpan.innerText = total;
    };

    window.toggleCart = () => {
        document.getElementById('cartSidebar').classList.toggle('active');
    };

    window.checkout = () => {
        if (cart.length === 0) return alert("Cart is empty");
        alert(`Proceeding to buy all ${cart.length} items for Rs.${document.getElementById('cartTotal').innerText}!`);
    };
</script>

<script>
const canvas = document.getElementById('bgCanvas');
const ctx = canvas.getContext('2d');
let particles=[];
function resize(){ canvas.width=window.innerWidth; canvas.height=window.innerHeight; }
window.addEventListener('resize',resize);
resize();

class Particle{
    constructor(type){ this.type=type; this.reset(); }
    reset(){
        this.x=Math.random()*canvas.width;
        this.y=Math.random()*canvas.height-canvas.height;
        this.size=this.type==='petal'?Math.random()*8+4:Math.random()*2+1;
        this.speed=Math.random()*1.5+.5;
        this.vx=Math.random()*1-.5;
        this.opacity=Math.random()*.6+.2;
        this.rot=Math.random()*360;
        this.rotSpd=Math.random()*2-1;
    }
    draw(){
        ctx.save();
        ctx.translate(this.x,this.y);
        ctx.rotate(this.rot*Math.PI/180);
        if(this.type==='petal'){
            ctx.fillStyle=`rgba(255,182,193,${this.opacity})`;
            ctx.beginPath(); ctx.moveTo(0,0);
            ctx.quadraticCurveTo(this.size,-this.size,this.size*2,0);
            ctx.quadraticCurveTo(this.size,this.size,0,0); ctx.fill();
        }else{
            ctx.shadowBlur=8; ctx.shadowColor='#fff';
            ctx.fillStyle=`rgba(255,255,255,${this.opacity})`;
            ctx.beginPath(); ctx.arc(0,0,this.size,0,Math.PI*2); ctx.fill();
        }
        ctx.restore();
    }
    update(){
        this.y+=this.speed; this.x+=this.vx+Math.sin(this.y/50); this.rot+=this.rotSpd;
        if(this.y>canvas.height+30) this.reset();
    }
}
function init(){
    for(let i=0;i<40;i++)particles.push(new Particle('petal'));
    for(let i=0;i<70;i++)particles.push(new Particle('shine'));
}
function animate(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    particles.forEach(p=>{ p.update(); p.draw(); });
    requestAnimationFrame(animate);
}
init(); animate();
</script>

</body>
</html>